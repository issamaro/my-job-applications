# Feature Spec: Import JSON Profile

**Date:** 2026-01-04
**Source:** backlog/done/import-json-profile.md
**Status:** Draft

---

## 1. Problem Statement

### User Request
> Allow users to import their complete profile data from a JSON file. This enables users to use external AI tools (like ChatGPT, Claude) to generate a well-structured profile JSON, then simply import it into the platform.

### Pain Point
Manually entering profile data (work history, education, skills, projects) is time-consuming. Users want to leverage AI assistants to generate structured profile data and quickly populate their CV without tedious form filling.

### User Persona
**Profile Owner** - A user who wants to quickly populate their CV profile using data generated by external AI tools, or migrate profile data from another source.

---

## 2. BDD Scenarios

```gherkin
Feature: Import JSON Profile
  As a profile owner
  I want to import my profile data from a JSON file
  So that I can quickly populate my CV without manual data entry

  Background:
    Given I am on the Profile Editor page
    And I have an existing profile with some data and a photo

  Scenario: Successful JSON import
    Given I have a valid JSON file with profile data
    When I click the "Import JSON" button
    And I select my JSON file
    Then I see a preview of the data to be imported
    And I see a confirmation dialog warning that existing data will be replaced
    When I confirm the import
    Then all profile sections are updated with the imported data
    And my existing profile photo is preserved
    And I see a success message "Profile imported successfully"

  Scenario: Import preserves profile photo
    Given I have an existing profile photo
    And I have a valid JSON file without a photo field
    When I complete the import process
    Then my existing profile photo remains unchanged
    And all other profile data is replaced with imported data

  Scenario: Invalid JSON syntax
    Given I have a file with invalid JSON syntax
    When I select the file for import
    Then I see an error message "Invalid JSON: [specific parse error]"
    And my existing profile data is unchanged
    And I can try again with a different file

  Scenario: JSON missing required fields
    Given I have a JSON file missing required fields (e.g., full_name)
    When I select the file for import
    Then I see validation errors listing the missing fields
    And I see "Missing required field: personal_info.full_name"
    And my existing profile data is unchanged

  Scenario: JSON with wrong data types
    Given I have a JSON file with wrong data types (e.g., graduation_year as string)
    When I select the file for import
    Then I see validation errors for the incorrect types
    And my existing profile data is unchanged

  Scenario: Empty arrays in JSON
    Given I have a valid JSON with empty arrays for some sections
    When I complete the import process
    Then those sections are cleared (empty)
    And sections with data are populated

  Scenario: User cancels import
    Given I have selected a valid JSON file
    And I see the confirmation dialog
    When I click "Cancel"
    Then the dialog closes
    And my existing profile data is unchanged

  Scenario: Download sample JSON schema
    When I click "Download Sample JSON"
    Then a JSON file with the expected schema structure is downloaded
    And it contains placeholder values showing the expected format
```

---

## 3. Requirements

### Must Have
- [ ] File input UI to select JSON file (accept=".json")
- [ ] JSON parsing with syntax error handling
- [ ] Schema validation against expected profile structure
- [ ] Required field validation (full_name, email, company, title, institution, degree, skill name, project name)
- [ ] Confirmation dialog before destructive import
- [ ] Bulk API endpoint to replace all profile data (except photo)
- [ ] Clear existing data and insert new data atomically
- [ ] Preserve existing profile photo during import
- [ ] Success/error feedback via Toast component
- [ ] Refresh ProfileEditor sections after successful import

### Should Have
- [ ] Download sample JSON button with schema template
- [ ] Preview of data before confirmation
- [ ] Drag-and-drop file upload (following PhotoUpload pattern)

### Won't Have
- JSON export functionality (separate feature)
- Partial/merge import
- Profile picture import via JSON
- URL/email format validation beyond basic schema
- Undo/rollback after import
- Import from URL

---

## 4. Assumptions

| Assumption | Category | Notes |
|------------|----------|-------|
| Backend can handle bulk import atomically | Architecture | Single API endpoint replaces all sections transactionally |
| Photo is stored separately at /api/photos | Architecture | Import endpoint does not touch photo endpoint |
| Frontend components can reload data after import | Architecture | Use existing loadData patterns or page refresh |
| JSON file size will be reasonable (<1MB) | UX | Profile data is text-based, should be small |
| Users understand JSON format or will use AI to generate it | UX | Sample JSON download helps with format |

---

## 5. Open Questions

- **Q1:** Should we show a diff/preview of what will change before import?
  - *Recommendation:* Show a simple preview (count of items per section) rather than full diff. Full diff is complex and out of scope.

- **Q2:** How should backend handle partial failures (e.g., one work experience fails validation)?
  - *Recommendation:* Validate all data upfront on frontend; backend should reject entire import if any item invalid (atomic operation).

- **Q3:** Should empty sections in JSON clear existing data or be skipped?
  - *Recommendation:* Empty arrays clear the section. Missing keys in JSON could skip that section, but for simplicity, require all keys present.

---

*Next: /v4-ux (UI changes required)*
